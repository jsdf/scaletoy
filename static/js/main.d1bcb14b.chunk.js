(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{15:function(e,n,t){e.exports=t(24)},21:function(e,n,t){},22:function(e,n,t){e.exports=t.p+"static/media/logo.5d5d9eef.svg"},23:function(e,n,t){},24:function(e,n,t){"use strict";t.r(n);var a=t(0),r=t.n(a),o=t(14),c=t.n(o),i=(t(21),t(2)),u=t(4),l=(t(22),t(23),t(1)),s=t(8),m=t(12);function d(e,n){var t=[],a=e.createMediaStreamDestination(),r=new MediaRecorder(a.stream);return n.connect(a),r.ondataavailable=function(e){t.push(e.data)},r.onstop=function(e){var n=new Blob(t,{type:"audio/ogg; codecs=opus"});document.createElement("audio");!function(e,n){var t=document.createElement("a");document.body.appendChild(t),t.style="display: none";var a=URL.createObjectURL(e);t.href=a,t.download=n,t.click(),URL.revokeObjectURL(a),t.remove()}(n,"audio.ogg")},r}var f=r.a.memo(function(e){var n=r.a.useRef(d(e.actx,e.inputNode)),t=r.a.useState(!1),a=Object(i.a)(t,2),o=a[0],c=a[1],u=r.a.useCallback(function(){return c(function(e){return!e})},[c]);return r.a.useEffect(function(){o?n.current.start():"inactive"!==n.current.state&&(n.current.stop(),n.current=d(e.actx,e.inputNode))},[o]),r.a.createElement("button",{onClick:u},o?"stop recording":"record")});function v(e,n){var t="scaletoy-".concat(e),r=Object(a.useState)(function(){try{var e=window.localStorage.getItem(t);return e?JSON.parse(e):n}catch(a){return console.log(a),n}}),o=Object(i.a)(r,2),c=o[0],u=o[1];return[c,function(e){try{var n=e instanceof Function?e(c):e;u(n),window.localStorage.setItem(t,JSON.stringify(n))}catch(a){console.log(a)}}]}var p=!0;var h={major:["I","ii","iii","VI","V","vi","vii*"],minor:["i","ii*","III","iv","v","VI","VII"]},b={major:["major","minor","minor","major","major","minor","diminished"],minor:["minor","diminished","major","minor","minor","major","major"]};function g(e,n){return s.a(e+" "+n).notes.map(function(e,t){return a=s.b(b[n][t]),r=e,a.map(function(e){return m.a("".concat(r).concat(e))}).sort(function(e,n){return e.intervals.length-n.intervals.length}).map(function(e){return"".concat(e.tonic).concat(e.aliases[0])});var a,r})}function E(e,n){var t=m.a(e),a=t.tonic+n;return t.intervals.map(function(e){return l.d(a,e)})}var y=.5,k=144,j=128,w=80,C=!1;function x(e,n,t,a){var r=l.b(n).midi,o=e;return e.forEach(function(e){e.message[1]==r&&(e.time=t-.01,e.message[0]=j)}),function(e,n){var t=e.concat(n);return t.sort(function(e,n){return e.time-n.time}),t}(o,[{message:[k,r,w],time:t},{message:[j,r,w],time:a}])}function O(){var e,n,t=s.a("c4 major").notes;return t.push((e=l.b(t[0]),n=1,"".concat(e.pc).concat(e.oct+n))),t}var I={major:"rgb(127,199,175)",minor:"rgb(255,158,157)",diminished:"rgb(218,216,167)"},N={display:"block",width:"100%",cursor:"pointer",color:"black",padding:4,paddingBottom:8,minHeight:40},S=r.a.memo(function(e){var n=e.chordData,t=e.playChord,a=e.setLastChord,o=e.octave,c=e.selected;return r.a.createElement("div",{style:Object(u.a)({},N,{background:I[n.chordType],border:"1px solid",borderColor:c?"rgba(0,0,0,0.2)":"transparent"}),onClick:function(){t(n,o),a(n.chordName),console.log(n)}},r.a.createElement("div",null,n.chordName,r.a.createElement("div",null,r.a.createElement("small",null,n.chord.name.length>3?n.chord.name:r.a.createElement("span",null,"\xa0"))),r.a.createElement("div",null,!1,!1)))});var T=function(){var e=r.a.useState(null),n=Object(i.a)(e,2),t=n[0],a=n[1],o=r.a.useCallback(function(){return t&&t.actx.resume()},[t]),c=r.a.useCallback(function(){return t&&t.actx.suspend()},[t]),u=v("key","c"),d=Object(i.a)(u,2),I=d[0],N=d[1],T=v("includeExtra",!1),M=Object(i.a)(T,2),L=M[0],R=M[1],z=r.a.useState([]),D=Object(i.a)(z,2),J=D[0],P=D[1],U=r.a.useCallback(function(){P(function(e){if(null!=t){var n=e,a=O(),r=t.actx.currentTime,o=0;return a.forEach(function(e){n=x(n,e,r+(o+=y),r+o+y)}),n}})}),A=r.a.useCallback(function(e,n){var a=E(e.chordName,n);P(function(e){if(null!=t){var n=e,r=t.actx.currentTime;return a.forEach(function(e,t){n=x(n,e,r+.02*t,r+y)}),n}})},[P,t]),B=r.a.useState(null),V=Object(i.a)(B,2),W=V[0],X=V[1],q=v("octave",4),F=Object(i.a)(q,2),H=F[0],$=F[1],G=v("scaleType","major"),K=Object(i.a)(G,2),Q=K[0],Y=K[1],Z=r.a.useMemo(function(){return function(e,n){var t=s.a("".concat(e," ").concat(n)).notes,a=new Map(g(e,n).map(function(e,t){return[t,e.map(function(e){var a=m.a(e);return{pos:t,chord:a,chordType:b[n][t],chordName:e,size:a.intervals.length*("Unknown"===a.quality?-1:1)}})]})),r=new Set;return a.forEach(function(e,n){e.forEach(function(e){r.add(e.size)})}),{scaleType:n,key:e,scalePitchClasses:t,scalePosChords:a,sizes:Array.from(r).sort(function(e,n){return e-n})}}(I,Q)},[I,Q]),_=r.a.useCallback(function(){return R(function(e){return!e})});return r.a.useEffect(function(){window.onDX7Init=function(e,n){var t={dx7:e,actx:n};setInterval(function(){P(function(e){return function(e,n){for(var t=0;t<e.length;t++){var a=e[t];if(a.time>n.actx.currentTime)break;n.dx7.onMidi(a.message)}return 0===t?e:e.slice(t)}(e,t)})},1),C&&function(e){var n=O(),t=0,a=null;setInterval(function(){null!=a&&e.dx7.onMidi([j,l.b(n[a]).midi,w]),e.dx7.onMidi([k,l.b(n[t]).midi,w]),a=t,t=(t+1)%n.length},1e3*y)}(t),a(t)},initDX7()},[]),r.a.createElement("div",{className:"App"},r.a.createElement("button",{onClick:o},"start audio"),r.a.createElement("button",{onClick:c},"pause audio"),t&&r.a.createElement(f,{actx:t.actx,inputNode:t.dx7}),r.a.createElement("div",null,r.a.createElement("label",null,"key:"," ",r.a.createElement("select",{value:Z.key,onChange:function(e){return N(e.currentTarget.value)}},["a","b","c","d","e","f","g"].map(function(e){return r.a.createElement("option",{key:e,value:e},e)})))," ",r.a.createElement("label",null,"octave:"," ",r.a.createElement("select",{value:H,onChange:function(e){return $(parseInt(e.currentTarget.value))}},[1,2,3,4,5,6,7].map(function(e){return r.a.createElement("option",{key:e,value:e},e)})))," ",r.a.createElement("label",null,"scale type:"," ",r.a.createElement("select",{value:Q,onChange:function(e){return Y(e.currentTarget.value)}},["major","minor"].map(function(e){return r.a.createElement("option",{key:e,value:e},e)})))," ",r.a.createElement("label",null,"scale notes: "),Array.from(Z.scalePosChords.keys()).map(function(e){return Z.scalePitchClasses[e]}).join()," ",r.a.createElement("label",null,r.a.createElement("input",{type:"checkbox",onChange:_,checked:L}),"include extra chords"),r.a.createElement("button",{onClick:U},"play scale")),Z.sizes.filter(function(e){return!!L||e>0}).sort(function(e,n){return p?e-n:n-e}).map(function(e,n){return r.a.createElement("div",{key:n},!1,r.a.createElement("br",null),r.a.createElement("div",{key:e,style:{display:"flex"}},Array.from(Z.scalePosChords).map(function(t){var a=Object(i.a)(t,2),o=a[0],c=a[1];return r.a.createElement("div",{key:o,style:{flex:1}},0===n&&r.a.createElement("div",null,h[Q][o]),c.filter(function(n){return n.size===e}).sort(function(e,n){return e.chordName.length-n.chordName.length}).map(function(e,n){return r.a.createElement(S,Object.assign({key:n},{chordData:e,playChord:A,setLastChord:X,octave:H,selected:e.chordName===W}))}))})))}),r.a.createElement("pre",{style:{height:300,overflow:"scroll"}},J.map(function(e){return JSON.stringify(e)}).join("\n")))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(r.a.createElement(T,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[15,1,2]]]);
//# sourceMappingURL=main.d1bcb14b.chunk.js.map